---
title: "Population Graphs On Contigs: Topological Convergence"
description: |
  With the ever increasing use of sequencing in the analysis of both neutral and putatively adaptive genetic variance the ability to recover genetic covartiance becomes increasinly difficult as the density of information rich genetic markers incereases.  In this manuscript, we examine the extent to which population genetic structure, as measured through population graphs, is influenced by locus proximity.
author:
  - name: Rodney J. Dyer
    url: https://dyerlab.org
    affiliation: Center for Environmental Studies<br>Virginia Commonwealth University<br>&nbsp;
    affiliation_url: https://ces.vcu.edu
    orcid_id: 0000-0003-4707-3453
date: "`r Sys.Date()`"
bibliography: bibliography.bib
output: distill::distill_article
knit: (function(inputFile, encoding) { 
  rmarkdown::render(inputFile,
                    encoding=encoding,
                    output_file='docs/index.html') })
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
options( tidyverse.quiet = TRUE, 
         dplyr.summarise.inform = FALSE )

library( tidyverse )
theme_set( theme_minimal(base_size=14 ))

#if( length(list.files("./data/", pattern = ".sqlite")) < 1 ) { 
#  source("R/SNPSummaries.R")
#}
```



Specifically, we test the following questions:  

1. How many SNP loci are necessary to gain a stable genetic covariance structure as measured through a population graph?

2. Are there metrics that can be used to define topological and structural similarity in one or more population graphs?

3. Some other thing.




# Methods


## Graph Theoretic Definitions

A graph contains two sets of objects, *nodes* often representing sampling locales, populations, or regions, and *edges* which specify the relationships between individual nodes.  In population genetic studies, graphs are often defined based upon pair-wise genetic distances (Nei's Distance, $D_{ps}$, etc.) or estimates of structure (pairwise $F_{ST}$, cGD, etc).

For the purposes of this paper, genetic topologies will be created using conditional genetic distance (cGD) found within Population Graph [@Dyer2004,@Dyer2015]

## The Data

```{r}
load("data/df_snps.rda")
K <- nrow(df_snps)
df_snps$dist <- NA
df_snps$dist[2:K] = df_snps$Location[2:K] - df_snps$Location[1:(K-1)]
```


For this manuscript, single nucleotide polymorphisms (SNP) data from HGDP-CEPH for Chromosome 2 were used due to the relative density of variable markers.  These data consist of `r K` mapped variable nucleotide sites.  Distances between individual snps ranged from `r min(df_snps$dist, na.rm=TRUE)`bp - `r format(max(df_snps$dist, na.rm=TRUE),digits=2, scientific=TRUE)`bp (the largest spanning the centromere), whose distribution of inter-snp distances are arranged as shown in Figure \@ref(fig:snp-distance). 

```{r snp-distance, fig.cap="The distribution of nearest neighbor distances for individual SNPs along Chromosome 2"}
df_snps %>%
  filter( !is.na(dist) ) %>%
  ggplot( aes(log(dist,base = 10)  ) ) + 
  geom_density()  + 
  xlab(expression(log[10](Nucleotide~Distance))) +
  ylab("Frequency")
```

## Topological Similarity


### Isomorphism in Graph Structure

As a first pass, one can consider the structural similarity of twwo graphs.  For example, consider the graphs $G$ and $H$, both of which have identical node sets (e.g., the two graphs have the same cardinality in that $V(G) = V(H)$).  For most purposes here, we will only be considering comparisons of graphs that have the identical set of nodes as we are looking at population-level genetic covariance among the same set of populations only with different sets of genetic markers.

In this context, any pair of population graphs are said to be *graph-level isomorphic* if and only if the exact same set of edges in popgraph $G$ are present in other popgraph $H$.




Network similarity may be partitioned into features based upon the *node*, on the *edge*, or on the overall construction of the network itself.  For comparision purposes, we will 

*Node Centric Features*  

- *Degree* The number of edges connected to a particular node in the network.    
- *Node Betweenness* A measure of the relative number of the shortest paths in the network that contain each node.
- *Node Closeness* The relative distance of a node to all other nodes in the network. 


*Edge Centric Features*

- *Edge Betweenness* The relative number of shortest paths in the entire network that contain each edge.
- *Distance Congruence* The r
- *Structural Congruence* 

*Graph Features*

- *Diameter* The distance through the graph connecting the two most distant nodes.
- *Slope<sub>Degree</sub>* - 

Feature                | Description    
-----------------------|------------------------------   
Degree                 | The number of edges connected to a node    
Node Betweenness       | The number of shortest paths in the network that traverse each node.
Node Closeness         | The relative closeness of a node to all other nodes in the network.
cGD                    | The length of the shortest path connecting nodes in the Population Graph   
Edge Betweenness       | The number of shortest paths in the network that traverse each edge    
Slope<sub>Degree</sub> | The slope of the degree distribution describing the
Diameter               |   
 






## Assympototic Stability


*Random Markers*


Asymptotic convergence on topology from random SNP's.


```{r cache=TRUE}
if( !file.exists("data/df_random_convergence.rda") ) {
  source("R/random_convergence.R")
} else { 
  load("data/df_random_convergence.rda")
  df_random_convergence %>%
    ggplot( aes(Size, StructVar)) + 
    geom_point()
            
}

```


*Sequential Markers*

Asymptotic convergence on topollgy from sequential SNP's.






## Sampling Intensity

















# Acknowledgements







